usePlugin 'java'
usePlugin 'maven'

	group = 'fspotcloud.bot-dispatch'
	version = '0.2-botdispatch'

configurations.compile.transitive = true

	sourceCompatibility = 1.6
	targetCompatibility = 1.6

repositories {
 		mavenRepo urls: ["http://maven.fspotcloud.googlecode.com/hg/repo"]
 		mavenRepo urls: ["http://repo1.maven.org/maven2"]
}
	dependencies {
	compile "javax.persistence:persistence-api:1.0.2"
	compile "fspotcloud.bot-dispatch:command-api:0.2-botdispatch"
	compile("javax.jdo:jdo2-api:2.3-eb") {
		exclude(module: 'transaction-api')
		}
	compile "com.google.appengine.orm:datanucleus-appengine:1.0.4.1"
	compile("org.datanucleus:datanucleus-core:1.1.5") {
		exclude(module: 'transaction-api')
		}
	compile "com.google.appengine:appengine-api-1.0-sdk:1.6.0"
	compile "com.google.gwt:gwt-user:2.4.0"
	compile "net.customware.gwt.dispatch:gwt-dispatch:1.2.0"
	compile "javax.inject:javax.inject:1"
	compile "com.google.inject:guice:3.0"
	compile "com.google.inject.extensions:guice-persist:3.0"
	compile "commons-lang:commons-lang:2.6"
	compile "com.google.guiceberry:guiceberry:3.0.4"
	runtime "com.google.appengine:datanucleus-jpa:1.1.5"
	runtime "com.google.appengine:geronimo-jpa_3.0_spec:1.1.1"
	testCompile "fspotcloud.bot-dispatch:test:0.2-botdispatch"
	testCompile "com.google.gwt:gwt-servlet:2.4.0"
	testCompile "com.google.guava:guava-testlib:10.0.1"
	testCompile "junit:junit:4.10"
	}

task replacePoms(dependsOn: install) << {
    def pomsDir = new File(project.buildDir, "poms")
    def defaultPomName = "pom-default.xml"
    def defaultPom = new File(pomsDir, defaultPomName)
    if (defaultPom.exists()) {
      File pomFile = new File(project.projectDir, "pom.xml")
      if (pomFile.exists()) {
        pomFile.renameTo(new File(project.projectDir, "pom.xml.bak"))
      }
      project.copy {
        from(pomsDir) {
          include defaultPomName
          rename defaultPomName, 'pom.xml'
        }
        into(project.projectDir)
      }
    }
}